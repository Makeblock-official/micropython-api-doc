.. _TPYBoard_tutorial_18b20tem:

[Micropython]TPYBoard F407 驱动DS3231读取时间、温度
=====================================================

实验目的
--------------

- 学习在PC机系统中扩展简单I/O 接口的方法。
- 学习硬件接线方法。
- 学习TPYBoard F407 Micropython开发板中I2C接口的用法。
   
所需元器件
-------------

- TPYBoard F407 Micropython开发板一块
- DS3231时钟模块一个
- 数据线一条
- 杜邦线若干
- PuTTY调试工具
 
DS3231的接线方法
-------------------------

DS3231时钟模块，通信用的是IIC接口在这只用到DS3231时钟模块的SCL,SDA,VCC,GND四个针脚即可设定读出时间和温度，下面是接线方法。

.. image:: http://old.tpyboard.com/document/documents/tb407/3231time_1.png

F407 Micropython开发板和DS3231时钟模块的针脚对应关系如下：
IIC接口1的接线方法（程序中ds=DS3231(1)调用IIC接口1）

+------------------------+----------------+
| TPYBoard F407          | DS3231时钟模块 |
+========================+================+
|    Y6                  |  SCL           |
+------------------------+----------------+
|    Y5                  |  SDA           |
+------------------------+----------------+
|    3V3                 |  VCC           |
+------------------------+----------------+
|    GND                 |  GND           |
+------------------------+----------------+

IIC接口2的接线方法（程序中ds=DS3231(2)调用IIC接口2）

+------------------------+----------------+
| TPYBoard F407          | DS3231时钟模块 |
+========================+================+
|   X32                  |  SCL           |
+------------------------+----------------+
|   X33                  |  SDA           |
+------------------------+----------------+
|   3V3                  |  VCC           |
+------------------------+----------------+
|   GND                  |  GND           |
+------------------------+----------------+

              
源代码
---------------

接线OK后，导入DS3231.py，编写main.py保存，等红灯熄灭后，RST开发板，用PuTTY可以看到时间和温度。

.. code-block:: python

	# main.py -- put your code here!
	import pyb
	from DS3231 import DS3231  
	ds=DS3231(1)
	#设置时间
	#ds.TIME([17,40,30])

	#读取秒
	ds.sec()
	print(ds.sec())
	#读取时间
	ds.TIME()
	print(ds.TIME())
	#读取日期
	ds.DATE()
	print(ds.DATE())
	#读取温度
	ds.TEMP()
	print(ds.TEMP())


* `下载源码 <http://old.tpyboard.com/document/documents/tb407/ds3231.rar>`_ 